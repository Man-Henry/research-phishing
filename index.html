<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phishing Detection Suite - Web Application</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="dark-theme">
    <!-- Navigation Bar -->
    <nav class="navbar navbar-dark bg-dark border-bottom">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="bi bi-shield-check"></i> Phishing Detection Suite
            </span>
            <span class="badge bg-success">
                <i class="bi bi-circle-fill badge-icon-sm"></i> Online
            </span>
        </div>
    </nav>

    <!-- Tab Navigation -->
    <ul class="nav nav-tabs" id="mainTabs">
        <li class="nav-item">
            <button class="nav-link active" id="email-tab" data-bs-toggle="tab" data-bs-target="#email-panel" type="button">
                <i class="bi bi-envelope"></i> Email Detector
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" id="file-tab" data-bs-toggle="tab" data-bs-target="#file-panel" type="button">
                <i class="bi bi-file-earmark-binary"></i> File Analyzer
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" id="about-tab" data-bs-toggle="tab" data-bs-target="#about-panel" type="button">
                <i class="bi bi-info-circle"></i> About
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" id="help-tab" data-bs-toggle="tab" data-bs-target="#help-panel" type="button">
                <i class="bi bi-question-circle"></i> Help
            </button>
        </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content" id="mainTabContent">
        
        <!-- Email Detector Tab -->
        <div class="tab-pane fade show active" id="email-panel" role="tabpanel">
            <div class="container my-4">
                <div class="row">
                    <div class="col-lg-10 mx-auto">
                        <div class="card shadow-lg">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0"><i class="bi bi-envelope-open"></i> Email Phishing Detector</h5>
                            </div>
                            <div class="card-body">
                                <p class="text-muted mb-4">
                                    <i class="bi bi-info-circle"></i> 
                                    Analyze suspicious emails with multilingual support (English, Vietnamese, Chinese)
                                </p>

                                <!-- Email Analysis Form -->
                                <form id="emailForm">
                                    <div class="mb-3">
                                        <label for="emailHeaders" class="form-label fw-bold">Email Headers</label>
                                        <textarea class="form-control" id="emailHeaders" rows="3" 
                                            placeholder="From: sender@example.com&#10;To: recipient@example.com&#10;Subject: Verify Your Account"></textarea>
                                        <div class="form-text">
                                            Paste email headers (From, To, Subject, etc.)
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="emailBody" class="form-label fw-bold">
                                            Email Content <span class="text-danger">*</span>
                                        </label>
                                        <textarea class="form-control" id="emailBody" rows="6" required
                                            placeholder="Paste the full email content here..."></textarea>
                                        <div class="form-text">
                                            Required - Paste the complete email body text
                                        </div>
                                    </div>

                                    <button type="submit" class="btn btn-primary btn-lg w-100">
                                        <i class="bi bi-search"></i> Analyze Email
                                    </button>
                                </form>

                                <!-- Loading Spinner -->
                                <div id="emailLoading" class="mt-4 text-center hidden">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Analyzing...</span>
                                    </div>
                                    <p class="mt-2 text-muted">Analyzing email content...</p>
                                </div>

                                <!-- Results Section -->
                                <div id="emailResults" class="mt-4 hidden">
                                    <hr>
                                    <h5 class="mb-3">Analysis Results</h5>

                                    <!-- Threat Alert -->
                                    <div id="threatAlert" class="alert">
                                        <h6 id="threatTitle"></h6>
                                        <p id="threatMessage" class="mb-0"></p>
                                    </div>

                                    <!-- Confidence Score -->
                                    <div class="mb-3">
                                        <label class="form-label fw-bold">Confidence Score</label>
                                        <div class="progress progress-lg">
                                            <div id="confidenceBar" class="progress-bar" role="progressbar" aria-label="Confidence score"></div>
                                        </div>
                                        <small id="confidenceText" class="text-muted"></small>
                                    </div>

                                    <!-- Language Detection -->
                                    <div id="languageCard" class="card mb-3 hidden">
                                        <div class="card-header bg-info text-white">
                                            <h6 class="mb-0"><i class="bi bi-translate"></i> Language Detection</h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="languageInfo"></div>
                                        </div>
                                    </div>

                                    <!-- Authentication Details -->
                                    <div id="authCard" class="card mb-3 hidden">
                                        <div class="card-header">
                                            <h6 class="mb-0"><i class="bi bi-shield-lock"></i> Authentication</h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="authDetails"></div>
                                        </div>
                                    </div>

                                    <!-- Content Analysis -->
                                    <div id="contentCard" class="card hidden">
                                        <div class="card-header">
                                            <h6 class="mb-0"><i class="bi bi-file-text"></i> Content Analysis</h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="contentDetails"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- File Analyzer Tab -->
        <div class="tab-pane fade" id="file-panel" role="tabpanel">
                <div class="row">
                    <div class="col-lg-10 mx-auto">
                        <div class="card shadow-lg">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0"><i class="bi bi-file-earmark-binary"></i> File Malware Analyzer</h5>
                            </div>
                            <div class="card-body">
                                <p class="text-muted mb-4">
                                    <i class="bi bi-info-circle"></i> 
                                    Upload and scan files for malware signatures and suspicious patterns
                                </p>

                                <!-- File Upload Form -->
                                <form id="fileForm">
                                    <div class="mb-3">
                                        <label for="fileInput" class="form-label fw-bold">
                                            Select File <span class="text-danger">*</span>
                                        </label>
                                        <input type="file" class="form-control" id="fileInput" required>
                                        <div class="form-text">
                                            Supported: exe, dll, bin, elf, zip, rar, pdf, doc, docx | Max: 50MB
                                        </div>
                                    </div>

                                    <button type="submit" class="btn btn-success btn-lg w-100">
                                        <i class="bi bi-play-circle-fill"></i> Analyze File
                                    </button>
                                </form>

                                <!-- Loading -->
                                <div id="fileLoading" class="mt-4 text-center hidden">
                                    <div class="spinner-border text-success" role="status">
                                        <span class="visually-hidden">Analyzing...</span>
                                    </div>
                                    <p class="mt-2 text-muted">Analyzing file...</p>
                                </div>

                                <!-- Results -->
                                <div id="fileResults" class="mt-4 hidden">
                                    <hr>
                                    <h5 class="mb-3">Analysis Results</h5>

                                    <!-- Threat Alert -->
                                    <div id="fileThreatAlert" class="alert">
                                        <h6 id="fileThreatTitle"></h6>
                                        <p id="fileThreatMessage" class="mb-0"></p>
                                    </div>

                                    <!-- File Info -->
                                    <div class="card bg-light mb-3">
                                        <div class="card-body">
                                            <strong>Filename:</strong> <span id="filename"></span>
                                        </div>
                                    </div>

                                    <!-- Confidence -->
                                    <div class="mb-4">
                                        <label class="fw-bold">Threat Confidence:</label>
                                        <div class="progress progress-lg">
                                            <div id="fileConfidenceBar" class="progress-bar progress-bar-striped progress-bar-animated progress-bar-initial" role="progressbar" aria-label="Threat confidence">
                                                <span id="fileConfidenceText" class="fw-bold">0%</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- File Hashes -->
                                    <div class="card mb-4">
                                        <div class="card-body">
                                            <h6 class="card-title"><i class="bi bi-fingerprint"></i> File Hashes</h6>
                                            <div class="small font-monospace">
                                                <div class="mb-2">
                                                    <strong>MD5:</strong><br>
                                                    <code id="hashMD5"></code>
                                                </div>
                                                <div class="mb-2">
                                                    <strong>SHA1:</strong><br>
                                                    <code id="hashSHA1"></code>
                                                </div>
                                                <div>
                                                    <strong>SHA256:</strong><br>
                                                    <code id="hashSHA256"></code>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Binary Analysis -->
                                    <div class="card mb-4">
                                        <div class="card-body">
                                            <h6 class="card-title"><i class="bi bi-code-square"></i> Binary Analysis</h6>
                                            <ul class="list-unstyled mb-0">
                                                <li><strong>Entropy:</strong> <span id="entropy"></span> (0-8 scale)</li>
                                                <li><strong>PE Header:</strong> <span id="peHeader"></span></li>
                                                <li><strong>ELF Header:</strong> <span id="elfHeader"></span></li>
                                                <li><strong>Suspicious Strings:</strong> <span id="suspiciousStrings"></span></li>
                                            </ul>
                                        </div>
                                    </div>

                                    <!-- Recommendation -->
                                    <div class="alert alert-info">
                                        <strong><i class="bi bi-lightbulb"></i> Recommendation:</strong>
                                        <span id="fileRecommendation"></span>
                                    </div>
                                </div>

                                <!-- Error -->
                                <div id="fileError" class="alert alert-danger mt-4 hidden"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- About Tab -->
            <div class="tab-pane fade" id="about-panel" role="tabpanel">
                <div class="row">
                    <div class="col-lg-10 mx-auto">
                        <div class="card shadow-lg">
                            <div class="card-header bg-info text-white">
                                <h5 class="mb-0"><i class="bi bi-info-circle"></i> About This System</h5>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">What is this?</h5>
                                <p>The Phishing Detection Suite is a machine learning-based application designed to detect:</p>
                                <ul>
                                    <li><strong>Phishing Emails</strong> - Fraudulent emails designed to steal credentials</li>
                                    <li><strong>Malware Files</strong> - Files containing malicious code or threats</li>
                                </ul>

                                <hr>

                                <h5 class="card-title mt-4">Multilingual Detection</h5>
                                <p>Our advanced system detects phishing in multiple languages:</p>
                                <div class="row g-3">
                                    <div class="col-md-4">
                                        <div class="card bg-light">
                                            <div class="card-body text-center">
                                                <i class="bi bi-globe icon-large text-primary"></i>
                                                <h6 class="mt-2">English</h6>
                                                <p class="small mb-0">13 phishing keywords</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card bg-light">
                                            <div class="card-body text-center">
                                                <i class="bi bi-globe icon-large text-success"></i>
                                                <h6 class="mt-2">Tiếng Việt</h6>
                                                <p class="small mb-0">14 phishing keywords</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card bg-light">
                                            <div class="card-body text-center">
                                                <i class="bi bi-globe icon-large text-danger"></i>
                                                <h6 class="mt-2">中文</h6>
                                                <p class="small mb-0">10 phishing keywords</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr>

                                <h5 class="card-title mt-4">Technology Stack</h5>
                                <ul>
                                    <li><strong>Machine Learning:</strong> scikit-learn, Random Forest, Gradient Boosting</li>
                                    <li><strong>Backend:</strong> Flask (Python web framework)</li>
                                    <li><strong>Frontend:</strong> Bootstrap 5.3, HTML5, JavaScript</li>
                                    <li><strong>Analysis:</strong> NLTK, NumPy, Pandas</li>
                                </ul>

                                <div class="alert alert-warning mt-4">
                                    <strong><i class="bi bi-shield-check"></i> Defensive Security Tool</strong>
                                    <p class="mb-0">This tool is designed for detecting phishing attacks and analyzing files for malware. 
                                    It is NOT designed for creating malware or conducting phishing attacks.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Help Tab -->
            <div class="tab-pane fade" id="help-panel" role="tabpanel">
                <div class="row">
                    <div class="col-lg-10 mx-auto">
                        <div class="card shadow-lg">
                            <div class="card-header bg-warning text-dark">
                                <h5 class="mb-0"><i class="bi bi-question-circle"></i> Help & FAQ</h5>
                            </div>
                            <div class="card-body">
                                <div class="accordion" id="helpAccordion">
                                    <!-- Email Detection Help -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#emailHelp">
                                                <i class="bi bi-envelope-check"></i>&nbsp; How to use Email Detector?
                                            </button>
                                        </h2>
                                        <div id="emailHelp" class="accordion-collapse collapse show">
                                            <div class="accordion-body">
                                                <ol>
                                                    <li>Go to the <strong>Email Detector</strong> tab</li>
                                                    <li>Paste the email body in the first field</li>
                                                    <li>(Optional) Paste email headers in the second field for better accuracy</li>
                                                    <li>Click <strong>Analyze Email</strong></li>
                                                    <li>Review the results and recommendations</li>
                                                </ol>
                                                <hr>
                                                <h6>What does "PHISHING" mean?</h6>
                                                <p>Phishing is a fraudulent attempt to steal your information (passwords, credit cards, etc.) by disguising an email as legitimate.</p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Multilingual Help -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#multilingualHelp">
                                                <i class="bi bi-globe"></i>&nbsp; Multilingual Detection
                                            </button>
                                        </h2>
                                        <div id="multilingualHelp" class="accordion-collapse collapse">
                                            <div class="accordion-body">
                                                <h6>Supported Languages</h6>
                                                <ul>
                                                    <li><strong>English</strong> - 13 phishing keywords</li>
                                                    <li><strong>Vietnamese (Tiếng Việt)</strong> - 14 phishing keywords</li>
                                                    <li><strong>Chinese (中文)</strong> - 10 phishing keywords</li>
                                                </ul>
                                                <hr>
                                                <h6>Risk Multipliers</h6>
                                                <ul>
                                                    <li><strong>1.2x</strong> - High-risk languages (Vietnamese, Chinese)</li>
                                                    <li><strong>1.3x</strong> - Multilingual emails (2+ languages detected)</li>
                                                    <li><strong>Up to 1.56x</strong> - Combined maximum multiplier</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- File Analysis Help -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#fileHelp">
                                                <i class="bi bi-file-earmark-binary"></i>&nbsp; How to use File Analyzer?
                                            </button>
                                        </h2>
                                        <div id="fileHelp" class="accordion-collapse collapse">
                                            <div class="accordion-body">
                                                <ol>
                                                    <li>Go to the <strong>File Analyzer</strong> tab</li>
                                                    <li>Click on the file input or drag & drop</li>
                                                    <li>Select a file from your computer</li>
                                                    <li>Results appear automatically</li>
                                                    <li>Review file hashes and analysis</li>
                                                </ol>
                                                <hr>
                                                <h6>Supported File Types</h6>
                                                <p>exe, dll, bin, elf, zip, rar, pdf, doc, docx (Max: 50MB)</p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Confidence Scores -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#confidenceHelp">
                                                <i class="bi bi-percent"></i>&nbsp; Understanding Confidence Scores
                                            </button>
                                        </h2>
                                        <div id="confidenceHelp" class="accordion-collapse collapse">
                                            <div class="accordion-body">
                                                <h6>Risk Levels</h6>
                                                <ul>
                                                    <li><span class="badge bg-success">Safe</span> - Confidence ≥ 70%</li>
                                                    <li><span class="badge bg-warning">Low Risk</span> - 50-70%</li>
                                                    <li><span class="badge bg-info">Uncertain</span> - &lt;50%</li>
                                                    <li><span class="badge bg-danger">High/Critical</span> - Phishing 60-100%</li>
                                                </ul>
                                                <div class="alert alert-info mt-3">
                                                    <strong>Note:</strong> "Uncertain" doesn't mean safe - it means the system is unsure. Always manually verify emails with confidence &lt; 70%.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-3 mt-5">
        <div class="container-fluid px-4 text-center">
            <p class="mb-0">&copy; 2025 Phishing Detection Suite | Web Application</p>
            <p class="small text-muted mb-0">Defensive Security | Educational Use Only</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
